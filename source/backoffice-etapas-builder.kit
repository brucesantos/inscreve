<!doctype html>
<html lang="pt">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Sistema Inscreve da FGV Conhecimento, para inscrições em concursos">
    <title>Inscreve - FGV Conhecimento</title>
    <!-- CSS do date range picker -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css">
    <!-- Lib do Quill editor de rich text para fazer o termo de aceite -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <!-- Nosso estilo -->
    <link href="styles/main.css" rel="stylesheet">
  </head>

  <body class="bg-light">
    <!-- também conhecido como navbar -->
    <!-- @import header-fgv -->

    <main class="container">

      <div class="mt-4 d-flex align-items-center justify-content-between">
        <div>
          <h1 class="fs-3 mb-0">Construtor de etapas</h1>
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="backoffice-concursos.html">Concursos</a></li>
              <li class="breadcrumb-item"><a href="backoffice-concurso-exemplo.html">24786764896</a></li>
              <li class="breadcrumb-item"><a href="backoffice-concurso-exemplo.html">Etapas</a></li>
              <li class="breadcrumb-item active" aria-current="page">Cargo: Professor de matemática</li>
            </ol>
          </nav>
        </div>
        <div class="d-flex align-items-center gap-2">
          <div class="small me-1">
            <div class="text-end opacity-50">Salvo pela última vez</div>
            <div class="text-end opacity-75">
              <span>16/11/2023</span>
              <span>às</span>
              <span>15:34:32</span>
            </div>
          </div>
          <button type="button" class="btn btn-primary">Salvar</button>
          <button type="button" class="btn btn-outline-primary p-0" style="width: 38px; height: 38px;">
            <svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M13 6.125C10.4219 6.125 8.35156 7.29688 6.75 8.78125C5.22656 10.1875 4.21094 11.8281 3.66406 13C4.21094 14.1719 5.22656 15.8516 6.75 17.2578C8.35156 18.7422 10.4219 19.875 13 19.875C15.5391 19.875 17.6094 18.7422 19.2109 17.2578C20.7344 15.8516 21.7891 14.1719 22.2969 13C21.7891 11.8281 20.7344 10.1875 19.25 8.78125C17.6094 7.29688 15.5391 6.125 13 6.125ZM5.46094 7.41406C7.29688 5.69531 9.83594 4.25 13 4.25C16.125 4.25 18.6641 5.69531 20.5 7.41406C22.3359 9.13281 23.5469 11.125 24.1328 12.5312C24.25 12.8438 24.25 13.1953 24.1328 13.5078C23.5469 14.875 22.3359 16.9062 20.5 18.625C18.6641 20.3438 16.125 21.75 13 21.75C9.83594 21.75 7.29688 20.3438 5.46094 18.625C3.625 16.9062 2.41406 14.875 1.82812 13.5078C1.71094 13.1953 1.71094 12.8438 1.82812 12.5312C2.41406 11.125 3.625 9.09375 5.46094 7.41406ZM13 16.125C14.7188 16.125 16.125 14.7578 16.125 13C16.125 11.2812 14.7188 9.875 13 9.875C12.9609 9.875 12.9219 9.875 12.9219 9.875C12.9609 10.1094 13 10.3047 13 10.5C13 11.9062 11.8672 13 10.5 13C10.2656 13 10.0703 13 9.875 12.9219C9.875 12.9609 9.875 13 9.875 13C9.875 14.7578 11.2422 16.125 13 16.125ZM13 8C14.7578 8 16.3984 8.97656 17.2969 10.5C18.1953 12.0625 18.1953 13.9766 17.2969 15.5C16.3984 17.0625 14.7578 18 13 18C11.2031 18 9.5625 17.0625 8.66406 15.5C7.76562 13.9766 7.76562 12.0625 8.66406 10.5C9.5625 8.97656 11.2031 8 13 8Z" fill="currentColor"/>
            </svg>                
          </button>
        </div>
      </div>
      <div class="coluna-de-etapas">
        
      </div>
      
      <!-- Botão para adicionar nova etapa -->
      <div class="text-center">
        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalEtapas">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="me-2">
            <path d="M10 4.375V15.625M4.375 10H15.625" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Adicionar nova etapa
        </button>
      </div>
        
    </main>

    <!-- ================================= -->
    <!-- MODAIS ========================== -->
    <!-- ================================= -->

    <!-- modal de etapas -->
    <div class="modal fade" id="modalEtapas" aria-hidden="true" tabindex="-1">
      <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Etapa</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label for="nomeEtapa" class="form-label">Nome da etapa</label>
              <input type="text" class="form-control" id="nomeEtapa" placeholder="Digite o nome da etapa">
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="dataInicio" class="form-label">Data e hora de início</label>
                <input type="datetime-local" class="form-control" id="dataInicio">
              </div>

              <div class="col-md-6 mb-3">
                <label for="dataFim" class="form-label">Data e hora de fim</label>
                <input type="datetime-local" class="form-control" id="dataFim">
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="button" class="btn btn-primary">Salvar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- modal de componentes -->
    <div class="modal fade" id="modalComponentes" aria-hidden="true" tabindex="-1">
      <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Escolha um Componente</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <input type="text" class="form-control" id="filtroComponentes" placeholder="Encontrar..." aria-label="Filtrar componentes">
            </div>
            <div id="opcoes-de-componentes-para-incluir" class="list-group">
              <!-- Arquivo -->
              <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#modalArquivo">
                <div class="me-3">
                  <img src="componentes-etapas/icones-componentes-etapas/icone-arquivo.svg" alt="Ícone de Arquivo">
                </div>
                <div>
                  <div class="component-title fw-bold">Arquivo</div>
                  <div class="component-description text-muted">Envio de arquivos como imagens, pdfs, etc.</div>
                </div>
                <div class="ms-auto">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 18L15 12L9 6" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
              </a>

              <!-- Celular -->
              <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#modalCelular">
                <div class="me-3">
                  <img src="componentes-etapas/icones-componentes-etapas/icone-celular.svg" alt="Ícone de celular">
                </div>
                <div>
                  <div class="component-title fw-bold">Celular</div>
                  <div class="component-description text-muted">Número de celular com validação e máscara</div>
                </div>
                <div class="ms-auto">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 18L15 12L9 6" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
              </a>

              <!-- CPF -->
              <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#modalCPF">
                <div class="me-3">
                  <img src="componentes-etapas/icones-componentes-etapas/icone-numero.svg" alt="Ícone de número">
                </div>
                <div>
                  <div class="component-title fw-bold">CPF</div>
                  <div class="component-description text-muted">Número do CPF com validação</div>
                </div>
                <div class="ms-auto">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 18L15 12L9 6" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
              </a>

              <!-- Data -->
              <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#modalData">
                <div class="me-3">
                  <img src="componentes-etapas/icones-componentes-etapas/icone-data.svg" alt="Ícone de data">
                </div>
                <div>
                  <div class="component-title fw-bold">Data</div>
                  <div class="component-description text-muted">Seleciona um dia específico dentro dos limites definidos</div>
                </div>
                <div class="ms-auto">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 18L15 12L9 6" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
              </a>

              <!-- Email -->
              <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#modalEmail">
                <div class="me-3">
                  <img src="componentes-etapas/icones-componentes-etapas/icone-email.svg" alt="Ícone de email">
                </div>
                <div>
                  <div class="component-title fw-bold">Email</div>
                  <div class="component-description text-muted">Email com validação de formato</div>
                </div>
                <div class="ms-auto">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 18L15 12L9 6" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
              </a>

              <!-- Lógica -->
              <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#modalLogica">
                <div class="me-3">
                  <img src="componentes-etapas/icones-componentes-etapas/icone-logica.svg" alt="Ícone de lógica">
                </div>
                <div>
                  <div class="component-title fw-bold">Lógica</div>
                  <div class="component-description text-muted">Condicionais e regras de exibição</div>
                </div>
                <div class="ms-auto">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 18L15 12L9 6" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
              </a>

              <!-- Municípios -->
              <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#modalMunicipios">
                <div class="me-3">
                  <img src="componentes-etapas/icones-componentes-etapas/icone-municipio.svg" alt="Ícone de mapa">
                </div>
                <div>
                  <div class="component-title fw-bold">Municípios</div>
                  <div class="component-description text-muted">Lista de municípios por estado</div>
                </div>
                <div class="ms-auto">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 18L15 12L9 6" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
              </a>

              <!-- NIS -->
              <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#modalNIS">
                <div class="me-3">
                  <img src="componentes-etapas/icones-componentes-etapas/icone-numero.svg" alt="Ícone de número">
                </div>
                <div>
                  <div class="component-title fw-bold">NIS</div>
                  <div class="component-description text-muted">Número de Identificação Social com validação</div>
                </div>
                <div class="ms-auto">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 18L15 12L9 6" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
              </a>

              <!-- Seleção -->
              <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#modalSelecao">
                <div class="me-3">
                  <img src="componentes-etapas/icones-componentes-etapas/icone-selecao.svg" alt="Ícone de seleção">
                </div>
                <div>
                  <div class="component-title fw-bold">Seleção</div>
                  <div class="component-description text-muted">Lista de opções com seleção única</div>
                </div>
                <div class="ms-auto">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 18L15 12L9 6" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg> 
                </div>
              </a>

              <!-- Texto -->
              <a href="#" class="list-group-item list-group-item-action d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#modalTexto">
                <div class="me-3">
                  <img src="componentes-etapas/icones-componentes-etapas/icone-texto.svg" alt="Ícone de texto">
                </div>
                <div>
                  <div class="component-title fw-bold">Texto</div>
                  <div class="component-description text-muted">Campo de texto com validações</div>
                </div>
                <div class="ms-auto">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 18L15 12L9 6" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
              </a>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- modais de opções dos componentes -->
    <!-- @import 'componentes-etapas/_cpf.kit' -->
    <!-- @import 'componentes-etapas/_nis.kit' -->
    <!-- @import 'componentes-etapas/_municipios.kit' -->
    <!-- @import 'componentes-etapas/_texto.kit' -->
    <!-- @import 'componentes-etapas/_selecao.kit' -->
    <!-- @import 'componentes-etapas/_arquivo.kit' -->
    <!-- @import 'componentes-etapas/_data.kit' -->
    <!-- @import 'componentes-etapas/_email.kit' -->
    <!-- @import 'componentes-etapas/_celular.kit' -->
    <!-- @import 'componentes-etapas/_logica.kit' -->
    

    <!-- ================================= -->
    <!-- SCRIPTS ========================= -->
    <!-- ================================= -->

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Sortable.js para drag and drop -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <!-- JS do date range picker e suas dependências (se utilizado) -->
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/min/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/daterangepicker@3.1/daterangepicker.min.js"></script>
    <!-- @import "scripts-gerais" -->
    <!-- Script específico para o construtor de etapas -->
    <script src="js/componentes.js"></script>
    <script src="js/etapas-builder.js"></script>
    <script>
      $(document).ready(function() {
        // Clear and focus the filter input when modal is shown
        $('#modalComponentes').on('shown.bs.modal', function() {
          $('#filtroComponentes').val('').focus();
          $('#opcoes-de-componentes-para-incluir .list-group-item').removeClass('d-none');
        });

        // Filter items as user types
        $('#filtroComponentes').on('input', function() {
          const searchTerm = $(this).val().toLowerCase();
          const listItems = $('#opcoes-de-componentes-para-incluir .list-group-item');
          
          listItems.each(function() {
            const title = $(this).find('.component-title').text().toLowerCase();
            const description = $(this).find('.component-description').text().toLowerCase();
            
            if (title.includes(searchTerm) || description.includes(searchTerm)) {
              $(this).removeClass('d-none');
            } else {
              $(this).addClass('d-none');
            }
          });
        });

        // Handle keyboard navigation
        $('#filtroComponentes').on('keydown', function(e) {
          const visibleItems = $('#opcoes-de-componentes-para-incluir .list-group-item:not(.d-none)');
          const currentItem = visibleItems.filter(':focus');
          let nextItem;

          switch(e.keyCode) {
            case 40: // Down arrow
              e.preventDefault();
              if (currentItem.length === 0) {
                nextItem = visibleItems.first();
              } else {
                nextItem = currentItem.nextAll('.list-group-item:not(.d-none)').first();
                if (nextItem.length === 0) {
                  nextItem = visibleItems.first();
                }
              }
              nextItem.focus();
              break;

            case 38: // Up arrow
              e.preventDefault();
              if (currentItem.length === 0) {
                nextItem = visibleItems.last();
              } else {
                nextItem = currentItem.prevAll('.list-group-item:not(.d-none)').first();
                if (nextItem.length === 0) {
                  nextItem = visibleItems.last();
                }
              }
              nextItem.focus();
              break;

            case 13: // Enter
              e.preventDefault();
              if (currentItem.length) {
                currentItem.trigger('click');
              }
              break;
          }

          // Scroll item into view if needed
          const focusedItem = visibleItems.filter(':focus');
          if (focusedItem.length) {
            const container = $('#opcoes-de-componentes-para-incluir');
            const itemTop = focusedItem.position().top;
            const containerHeight = container.height();
            const itemHeight = focusedItem.outerHeight();

            if (itemTop < 0) {
              container.scrollTop(container.scrollTop() + itemTop);
            } else if (itemTop + itemHeight > containerHeight) {
              container.scrollTop(container.scrollTop() + itemTop + itemHeight - containerHeight);
            }
          }
        });

      });
    </script>
  </body>
</html>